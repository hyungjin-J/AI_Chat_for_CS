ReqID,구분,난이도,사전 조건,상세 구현 가이드,시나리오 단계,중요도,필요 기술 스택
SYS-001,SYS,중,채널 설정 및 세션 저장소 구성 완료,"기능: 채널 진입 시 세션을 생성/복원한다. 로직/예외: customer_token 또는 anonymous_id 기준으로 활성 세션 조회 후 없으면 생성, 만료 세션은 신규 발급. 입출력: 입력(channel_id, locale, customer_token) / 출력(session_id, expires_at, status). AC: 1) 신규 방문 1초 내 세션 발급 2) 재방문 시 최근 대화 복원 3) 만료 세션은 분리 저장. 로그/메트릭: session_create_ms, session_restore_hit. 보안/개인정보: 세션 토큰 HttpOnly+Secure, user_id 해시 저장.",채팅 위젯 진입 → 세션 초기화,Must,"React, Spring Boot, Redis, PostgreSQL"
SYS-004,SYS,중,"로그 파이프라인 및 이벤트 스키마 합의, OTel Collector 연계","기능: 운영 관측의 단일 기준선으로 Trace/Metric/Log 상관관계를 강제한다. 로직/예외: trace_id/session_id/message_id를 API·AI·INT 전 구간에 전파하고 누락 이벤트는 저장 차단 후 경보를 발생시킨다. 입출력: 입력(request_context, telemetry_event) / 출력(correlated_observability_event). AC: 1) Trace-Metric-Log correlation 100% 2) 누락 trace_id 이벤트 0건(배포 게이트) 3) 단일 trace_id로 원인 추적 가능. 로그/메트릭: trace_coverage_pct, correlation_success_pct, missing_trace_event_count, dashboard_alert_latency_ms. 보안/개인정보: PII 마스킹 후 저장, RBAC 기반 조회 제어.",질문 입력 → 로그 저장,Must,"Spring Boot, OpenTelemetry, Micrometer, OpenSearch/Elasticsearch"
UI-002,UI,중,API-003 전송 API 준비,"기능: 멀티턴 입력, 수정, 재전송, 버튼형 답변(quick reply)을 지원한다. 로직/예외: draft/sent/retry 상태머신을 적용하고 quick reply도 동일 전송 검증 파이프라인을 사용한다. 입출력: 입력(text, quick_reply_id) / 출력(outbound_message, local_echo). AC: 1) 엔터/버튼 전송 동작 일치 2) 재전송 이력 표시 3) 버튼 중복 클릭 방지. 로그/메트릭: resend_count, input_validation_fail_count. 보안/개인정보: 스크립트 삽입 문자열 이스케이프 처리.",질문 입력 → 멀티턴 대화,Must,"React, TypeScript"
UI-004,UI,중,"API-004 SSE 연결 정상, PERF-001 SLO 합의","기능: SSE 기반 토큰 스트리밍과 스켈레톤/타이핑 인디케이터를 렌더링한다. 로직/예외: token/chunk/done/error 이벤트를 누적 파싱하고 done 이전 종료 시 자동 복구 플로우를 트리거한다. 입출력: 입력(SSE events) / 출력(incremental assistant message). AC: 1) first_token_ms 목표 1~2초(P95 <= 2초) 2) total_latency_ms P95 <= 15초 3) done 수신 전 종료 시 재연결/복구 UX 동작 4) 중복 chunk 무시. 로그/메트릭: first_token_ms, total_latency_ms, stream_reconnect_count. 보안/개인정보: 스트림 이벤트의 민감 필드 마스킹.",응답 생성 → 스트리밍,Must,"React, EventSource/Fetch stream, Nginx SSE, Client Telemetry"
UI-006,UI,하,SYS-003 공통 오류 규약 적용,"기능: 타임아웃/정책차단/도구실패별 오류 메시지와 재시도 UX를 제공한다. 로직/예외: error_code 카탈로그로 사용자 문구를 결정하고 재시도 가능 오류만 버튼을 노출한다. 입출력: 입력(error_code) / 출력(localized error UI). AC: 1) 오류 유형별 문구 분기 정확 2) 재시도 성공 시 배너 제거 3) 치명 오류는 상담원 연결 CTA 노출. 로그/메트릭: ui_error_code_count, retry_click_rate. 보안/개인정보: 내부 코드/스택 정보 UI 노출 금지.",응답 생성 → 오류 노출,Should,"React, i18n, Error Boundary"
SYS-002,SYS,중,테넌트 매핑 테이블 운영,"기능: host/tenant_key/locale 기반으로 정책 번들과 스킨을 라우팅한다. 로직/예외: 매핑 실패 시 default tenant로 폴백하고 경고 이벤트를 남긴다. 입출력: 입력(host, tenant_key, locale) / 출력(tenant_id, policy_bundle, theme). AC: 1) 유효 tenant_key는 올바른 정책 반영 2) 매핑 실패 시 서비스 중단 없이 default 적용 3) 라우팅 결과가 세션에 고정. 로그/메트릭: tenant_resolve_ms, tenant_fallback_count. 보안/개인정보: 테넌트 경계 간 데이터 접근 금지.",채팅 위젯 진입 → 테넌트 라우팅,Must,"Spring Boot, PostgreSQL, Redis"
UI-003,UI,중,API-007 업로드 엔드포인트 구현,"기능: 파일/이미지 첨부, 미리보기, 업로드 상태 표시를 제공한다. 로직/예외: 확장자/용량/MIME 검증 후 presigned URL 업로드를 수행하고 실패 파일만 개별 재시도한다. 입출력: 입력(file metadata, binary) / 출력(attachment_token, preview_url). AC: 1) 허용되지 않은 파일 차단 2) 부분 실패 시 성공 파일 유지 3) 모바일 카메라 업로드 지원. 로그/메트릭: upload_ms, upload_fail_rate. 보안/개인정보: 악성 파일 스캔 및 MIME 재검증.",질문 입력 → 첨부파일/이미지 업로드,Must,"React, File API, Object Storage"
SYS-003,SYS,하,에러 코드 카탈로그 정의,"기능: 내부 예외를 표준 에러코드와 사용자 메시지로 변환한다. 로직/예외: 도메인 예외는 카탈로그 매핑, 미분류 예외는 GENERIC_ERROR로 수렴한다. 입출력: 입력(exception, trace_id) / 출력(error_code, user_message, http_status). AC: 1) 모든 API가 동일 에러 포맷 반환 2) 스택트레이스 외부 노출 금지 3) 미분류 예외 비율 추적 가능. 로그/메트릭: error_code_count, unclassified_error_rate. 보안/개인정보: 에러 로그의 쿼리/헤더 민감값 마스킹.",질문 입력 → 공통 오류 처리,Must,"Spring Boot, Problem Details, OpenTelemetry"
UI-005,UI,중,UI-004 구현,"기능: 네트워크 단절 시 자동 재연결 및 이어받기를 수행한다. 로직/예외: Last-Event-ID/message_id로 재구독하고 실패 시 요약 재요청 fallback을 실행한다. 입출력: 입력(last_event_id, message_id) / 출력(resumed stream or fallback). AC: 1) 3회 이내 재연결 시도 2) 재연결 실패 시 명시적 안내 3) 복구 후 중복 문장 최소화. 로그/메트릭: reconnect_count, resume_success_rate. 보안/개인정보: 만료 토큰 재연결 요청은 재인증 후 진행.",스트리밍 → 재연결,Must,"React, SSE retry policy"
UI-001,UI,중,"SYS-001, API-001 연동","기능: 위젯 로딩 시 세션/히스토리를 복원하고 초기 화면을 구성한다. 로직/예외: 스켈레톤을 먼저 보여주고 세션 조회 성공 시 최근 메시지를 렌더, 실패 시 재시도 CTA를 노출한다. 입출력: 입력(session bootstrap) / 출력(message list UI). AC: 1) 초기 TTI 목표 충족 2) 재방문 히스토리/스크롤 복원 3) 복원 실패 시 빈 상태+재시도 제공. 로그/메트릭: ui_boot_tti_ms, history_render_ms. 보안/개인정보: 브라우저 저장소 민감정보 평문 저장 금지.",채팅 위젯 진입 → 히스토리 복원,Must,"React, TypeScript, Zustand"
UI-007,UI,중,API-005/006 및 INT-003 연동,"기능: CSAT/해결여부 수집과 상담원 전환 UX를 제공한다. 로직/예외: 대화 종료 또는 반복 실패 시 피드백 카드를 노출하고 미해결/고객요청/불만 조건이면 handoff CTA를 활성화한다. 입출력: 입력(csat_score, solved_flag, handoff_reason) / 출력(feedback ack, handoff request). AC: 1) 세션당 CSAT 1회 제한 2) handoff 조건 충족 시 버튼 노출 3) 이관 시 요약/최근대화/시도해결책 전달. 로그/메트릭: csat_completion_rate, handoff_click_rate. 보안/개인정보: 상담원 전달 컨텍스트에서 민감 필드 권한별 마스킹.",피드백/해결여부 확인 → 상담원 전환,Must,"React, Spring Boot API, Admin Console"
API-007,API,중,"API Gateway 정책 반영, Redis limiter 구성","기능: 에러코드 표준화와 rate-limit/quota/idempotency 규약을 공통 적용한다. 로직/예외: 429/Retry-After/X-RateLimit 헤더를 일관 제공하고, 입력/출력 토큰 예산, 툴호출 횟수 예산, 세션 누적 예산, SSE 동시연결 제한을 사용자/테넌트 기준으로 강제한다. 초과 시 정책에 따라 429 또는 403을 반환한다. 입출력: 입력(api request, budget context) / 출력(status, error_code, rate headers). AC: 1) 과호출 시 429 일관 처리 2) 예산 초과 코드 분리 3) SSE 동시연결 상한 강제 4) 문서화된 에러코드 외 값 금지. 로그/메트릭: rate_limited_count, quota_exceeded_count, token_budget_exceeded_count, sse_concurrency_reject_count. 보안/개인정보: IP+토큰 복합 기준 차단 및 우회 탐지.",공통 API 처리,Must,"Spring Boot, API Gateway, Redis Rate Limiter, Budget Service"
API-001,API,중,SEC-001 인증 체계 구성,"기능: POST /v1/sessions로 세션을 생성/복원한다. 로직/예외: client_nonce 중복 요청은 동일 session_id를 반환하고 인증 실패는 401 처리한다. 입출력: 입력(channel_id, locale, customer_token, client_nonce) / 출력(session_id, expires_at). AC: 1) 동일 nonce 재호출 시 멱등성 보장 2) 만료/무효 토큰은 401 3) 응답 스키마 버전 포함. 로그/메트릭: api_session_create_ms, session_create_qps. 보안/개인정보: JWT 검증 및 토큰 최소 권한 스코프 적용.",채팅 위젯 진입 → 세션 생성,Must,"Spring Boot, Redis, PostgreSQL"
API-002,API,하,API-001 구현,"기능: GET /v1/sessions/{id} 조회와 POST /v1/sessions/{id}/close 종료를 제공한다. 로직/예외: 조회는 커서 기반 페이징, 종료 후 추가 메시지 전송은 409로 차단한다. 입출력: 입력(session_id, cursor) / 출력(session state, messages[]). AC: 1) 종료 세션 전송 차단 2) 페이징 정합성 유지 3) 종료 이벤트 로그 기록. 로그/메트릭: session_fetch_ms, session_close_count. 보안/개인정보: 세션 소유권 검증 후 조회 허용.",채팅 위젯 진입 → 세션 조회/종료,Must,"Spring Boot, JPA"
API-006,API,중,OPS-001 지표 파이프라인 구성,"기능: 대화/도구호출/에러/latency/token 로그 저장 및 검색 API를 제공한다. 로직/예외: 쓰기는 append-only, 조회는 기간/세션/의도/에러코드 필터를 지원하고 과도한 조회는 제한한다. 입출력: 입력(filter query) / 출력(log page, aggregations). AC: 1) 조회 응답시간 목표 준수 2) 도구호출과 메시지 로그 상호 참조 가능 3) 논리삭제/보존정책 반영. 로그/메트릭: log_write_ms, log_search_ms, token_usage_sum. 보안/개인정보: 로그 조회 권한을 운영자 Role로 제한.",로그 저장 → 검색,Should,"Spring Boot, OpenSearch, PostgreSQL"
API-004,API,중,Nginx SSE 프록시 설정,"기능: GET /v1/sessions/{id}/stream SSE 엔드포인트를 제공한다. 로직/예외: event 타입(token/tool/citation/done/error) 표준화, heartbeat 누락 시 재연결 유도, 중단 시 resume token 발급. 입출력: 입력(session_id, message_id) / 출력(SSE events). AC: 1) 이벤트 순서 보장 2) done 전 종료 시 복구 정보 제공 3) 장기 연결 안정성 확보. 로그/메트릭: sse_conn_count, sse_drop_rate, first_token_ms. 보안/개인정보: 스트림 이벤트에서 민감 필드 제거.",응답 생성 → 스트리밍 엔드포인트,Must,"Spring WebFlux, SSE, Nginx"
API-005,API,하,UI-007 피드백 컴포넌트 구현,"기능: POST /v1/messages/{id}/feedback와 POST /v1/sessions/{id}/csat를 제공한다. 로직/예외: 메시지 평가는 upsert, 세션 CSAT은 종료 상태에서만 final 확정하고 중복 제출은 차단한다. 입출력: 입력(thumb, reason_code, csat_score, solved_flag) / 출력(feedback_id, saved_at). AC: 1) 세션당 CSAT 1회 2) score 범위 검증(1~5) 3) 제출 실패 시 재시도 가능. 로그/메트릭: feedback_api_ms, csat_save_ms, solved_ratio. 보안/개인정보: 자유코멘트 PII 마스킹 저장.",피드백/해결여부 확인,Must,"Spring Boot, PostgreSQL"
API-003,API,중,AI-001 전처리 필터 사용,"기능: POST /v1/sessions/{id}/messages로 메시지를 수신한다. 로직/예외: idempotency_key+session_id로 중복 전송을 차단하고 유효성 오류는 422 반환한다. 입출력: 입력(message_text, attachments, idempotency_key) / 출력(message_id, accepted_at). AC: 1) 중복 호출 시 동일 처리 결과 반환 2) 본문/첨부 검증 실패 시 422 3) 비동기 큐 적재 성공률 목표 충족. 로그/메트릭: message_post_ms, idempotency_hit_rate. 보안/개인정보: 본문 길이/금칙어/PII 사전 필터링 연계.",질문 입력 → 메시지 전송,Must,"Spring Boot, Validation, Queue"
KB-001,KB,중,관리자 권한모델 구성,"기능: FAQ/정책/매뉴얼 문서 업로드와 메타데이터 등록을 제공한다. 로직/예외: 파일 파싱 후 source/category/effective_date/owner를 강제 검증하고 실패 문서는 재처리 큐로 이동한다. 입출력: 입력(file, metadata) / 출력(doc_id, ingest_status). AC: 1) 필수 메타 누락 차단 2) 중복 해시 감지 3) 파싱 실패 재처리 가능. 로그/메트릭: kb_upload_ms, parse_fail_rate. 보안/개인정보: 업로드 권한과 문서 접근권한 분리.",문서 업로드/정제,Must,"Spring Boot, Object Storage, PostgreSQL"
AI-004,AI,상,KB-001/002 인덱스 준비,"기능: chunking/top-k/rerank 기반 RAG 검색을 수행한다. 로직/예외: 벡터 검색과 BM25 하이브리드 조회 후 rerank 점수로 근거를 선별하며 근거 0건이면 fallback 시나리오를 호출한다. 입출력: 입력(query_embedding, top_k) / 출력(chunks[], scores[]). AC: 1) top-k 정책 범위 강제 2) 검색 재현 가능한 trace 저장 3) 근거 부족 시 직접 단정 답변 금지. 로그/메트릭: rag_search_ms, rerank_gain, zero_evidence_rate. 보안/개인정보: 승인된 문서 버전만 검색 대상.",RAG 검색,Must,"Spring AI, pgvector, OpenSearch"
AI-003,AI,상,ADM-002 라우팅 규칙 배포,"기능: FAQ/RAG/Tool/Handoff 라우팅 결정을 수행한다. 로직/예외: intent+confidence+정책규칙+고객상태를 합산 평가하고 충돌 시 안전 우선 규칙을 적용한다. 입출력: 입력(intent, confidence, policy) / 출력(route_plan). AC: 1) 동일 입력에 일관된 경로 2) handoff 조건 즉시 전환 3) 규칙 변경 후 빠른 반영. 로그/메트릭: route_decision_ms, handoff_trigger_rate. 보안/개인정보: 승인된 규칙 버전만 운영 적용.",의도 분류 → 라우팅,Must,"Rule Engine, Spring Boot"
AI-007,AI,중,SEC-003 마스킹 정책 연동,"기능: 도구 파라미터 검증과 안전정책(환각 방지/확인질문/정보노출 차단)을 적용한다. 로직/예외: Pydantic(JSON Schema) 검증 실패 시 자동 보정 또는 clarify 질문으로 전환, 근거점수 미달 응답은 차단한다. 입출력: 입력(proposed_args, model_output, safety_score) / 출력(validated_action, final_response_type). AC: 1) 스키마 위반 파라미터 실행 금지 2) 불확실 응답은 확인질문 전환 3) 민감정보 요청 차단. 로그/메트릭: tool_param_invalid_rate, safety_block_count. 보안/개인정보: 민감정보 redaction 후 LLM 전달.",도구호출 → 검증/안전정책,Must,"Pydantic, Guardrails, Spring AI"
KB-002,KB,상,KB-001 업로드 완료,"기능: 정제된 문서를 청킹→임베딩→벡터/검색 인덱스로 적재한다. 로직/예외: chunk size/overlap 정책을 적용하고 임베딩 실패는 재시도 후 dead-letter 처리한다. 입출력: 입력(doc_id, chunk_policy) / 출력(chunk_ids, index_version). AC: 1) 색인 완료 후 검색 재현 테스트 통과 2) 정책 변경 시 신규 버전 생성 3) 재색인 스케줄 실행 가능. 로그/메트릭: embedding_ms, index_success_rate, reindex_count. 보안/개인정보: 폐기 문서는 인덱스에서 즉시 제외.",임베딩/벡터 색인,Must,"Spring Batch, Spring AI, pgvector"
KB-003,KB,중,KB-002 인덱스 운영,"기능: draft/approved/deprecated 상태와 버전/롤백/폐기/품질 리포트를 관리한다. 로직/예외: 승인 전 문서는 검색 제외, 버전 전환 시 영향도 계산, 주간 품질 리포트(커버리지/최신성/중복)를 산출한다. 입출력: 입력(doc_action, version_action) / 출력(workflow_state, quality_report). AC: 1) 승인자 분리 원칙 준수 2) 롤백 시 이전 검색결과 재현 3) 품질 임계치 미달 카테고리 알림. 로그/메트릭: approval_lead_time, rollback_count, kb_coverage_pct. 보안/개인정보: 감사로그 보관 및 승인 권한 제한.",승인 워크플로/버전 관리,Should,"Workflow Engine, PostgreSQL, BI"
AI-006,AI,상,INT-001~003 API 준비,"기능: 주문조회/배송조회/환불정책/티켓생성 Tool Calling을 오케스트레이션한다. 로직/예외: 모델이 제안한 tool_call을 allowlist로 검증 후 실행하고 실패 시 대체 안내 또는 handoff를 반환한다. 입출력: 입력(tool_name, args) / 출력(tool_result, tool_status). AC: 1) 허용 외 도구 실행 금지 2) 타임아웃/실패 처리 명확 3) 도구결과가 최종 응답에 반영. 로그/메트릭: tool_call_ms, tool_error_rate, tool_timeout_count. 보안/개인정보: ToolContext 최소 필드 원칙 적용.",RAG 검색 → 도구호출,Must,"Spring AI @Tool, HTTP Client"
AI-001,AI,중,ADM-001 정책 사전 준비,"기능: 입력 길이, 금칙어, PII 필터를 수행한다. 로직/예외: 정규식+사전+탐지모델 결합으로 차단/마스킹/경고 액션을 정책 버전에 따라 분기한다. 입출력: 입력(raw_text, locale) / 출력(filtered_text, policy_action). AC: 1) 최대 길이 초과 시 안내 메시지 2) PII 탐지 시 기본 마스킹 3) 금칙어 차단 이벤트 기록. 로그/메트릭: filter_block_count, pii_detect_rate. 보안/개인정보: 원문 최소 보존 및 접근통제.",질문 입력 → 전처리/필터링,Must,"Spring Boot, Regex, PII Detector"
AI-005,AI,중,"UI-002 근거 패널 구현, AI-009 Answer Contract 적용","기능: 응답에 근거 인용(citation)과 출처 메타를 포함한다. 로직/예외: 생성 단계에서 citation_id를 붙이고 UI 표시 포맷으로 변환하며, 인용 누락/근거 부족/스키마 실패 시 사용자 전송을 금지(fail-closed)한다. 입출력: 입력(answer_draft, evidence_chunks, schema_result) / 출력(answer_with_citation). AC: 1) 사실성 문장 근거 연결 2) 출처 클릭 시 원문 위치 확인 3) 인용 누락/스키마 실패/근거 부족은 전송 차단 4) 허용 대체 응답은 ""확인 필요/모름/추가 질문""만 가능. 로그/메트릭: citation_attach_ms, citation_missing_rate, fail_closed_block_count. 보안/개인정보: 비공개 문서 경로 외부 노출 금지.",응답 생성 → 인용/근거 표시,Must,"Spring Boot, Citation Assembler, Schema Validator"
AI-002,AI,중,AI-001 완료,"기능: 질문 의도를 FAQ/계정/주문/기술지원/불만으로 분류한다. 로직/예외: 룰 기반 1차 분류 후 모델 기반 보정, 신뢰도 임계치 미달 시 확인질문을 생성한다. 입출력: 입력(filtered_text, recent_history) / 출력(intent, confidence). AC: 1) 저신뢰 질문에 clarify 동작 2) 불만 intent는 handoff 우선 3) 분류 결과가 라우팅에 전달. 로그/메트릭: intent_latency_ms, low_confidence_rate. 보안/개인정보: 분류 입력에서 민감식별자 제거.",전처리/필터링 → 의도 분류,Must,"Spring AI, Classification Model"
ADM-001,ADM,중,SEC-002 권한체계 적용,"기능: 정책(금칙어/필수문구), 템플릿, 라우팅 규칙 CRUD와 승인 배포를 제공한다. 로직/예외: draft-review-approved 상태머신을 적용하고 승인 전 버전은 운영 트래픽에 반영하지 않는다. 입출력: 입력(change_set) / 출력(version, publish_status). AC: 1) 승인 없는 배포 차단 2) 변경 이력 diff 조회 가능 3) 롤백 시 이전 버전 즉시 복귀. 로그/메트릭: policy_publish_count, template_rollback_count. 보안/개인정보: 편집/승인 권한 분리 및 MFA 강제.",관리 콘솔 → 정책/템플릿/라우팅 관리,Must,"Admin UI, Spring Boot, PostgreSQL"
INT-003,INT,상,"UI-007, KB-003, 외부 티켓/CMS 권한 확보","기능: 티켓 생성/업데이트/상태 동기화와 FAQ CMS 반영 연동을 제공한다. 로직/예외: handoff 시 요약/최근대화/고객정보/시도해결책을 티켓 payload로 전송하고 상태 웹훅을 세션 타임라인에 반영, FAQ CMS는 승인 문서 버전만 동기화한다. 입출력: 입력(handoff_context, faq_version_event) / 출력(ticket_id, ticket_status, cms_sync_result). AC: 1) handoff 후 5초 내 ticket_id 반환 2) 웹훅 상태가 UI에 반영 3) 승인 전 FAQ 버전은 동기화 차단. 로그/메트릭: ticket_create_ms, ticket_sync_lag_ms, cms_sync_fail_rate. 보안/개인정보: 티켓 본문 PII 마스킹과 웹훅 서명 검증.",상담원 전환 → 티켓/FAQ CMS 동기화,Must,"Ticket API, Webhook, CMS API, Spring Boot"
INT-002,INT,중,SEC-003 키 관리 적용,"기능: 결제 상태 및 환불 정책/가능 여부 조회를 연동한다. 로직/예외: 정책 API 결과를 근거 코드와 함께 반환하고 지연 시 캐시 정책으로 폴백한다. 입출력: 입력(payment_id, order_id) / 출력(refund_policy_result). AC: 1) 환불 불가 사유 코드 표준화 2) 정책 버전과 결과 동시 표시 3) 지연 시 타임아웃/재시도 규칙 준수. 로그/메트릭: refund_policy_ms, refund_denied_ratio. 보안/개인정보: 결제 식별자 토큰화 및 시크릿 키 회전 적용.",도구호출 → 결제/환불 연동,Should,"REST Client, Vault, Spring Boot"
SEC-002,SEC,중,역할/권한 매트릭스 정의,"기능: 상담원/관리자/운영자 RBAC를 API와 UI에 일관 적용한다. 로직/예외: 서버 권한 기준으로 메뉴 노출을 제어하고 권한 변경 시 활성 세션 권한을 재평가한다. 입출력: 입력(user_role, resource) / 출력(allow/deny). AC: 1) 권한 없는 요청 403 2) 권한 변경 반영 지연 최소화 3) 권한 매트릭스 테스트 통과. 로그/메트릭: rbac_deny_count, privilege_change_audit. 보안/개인정보: 최소권한 원칙과 분리된 관리자 계정 적용.",콘솔 접근 → RBAC,Must,"Spring Security, RBAC"
OPS-002,OPS,중,OPS-001 KPI 파이프라인 운영,"기능: 대화 품질평가, 실패사유 분류, Top 문의 분석, A-B 테스트 결과를 운영한다. 로직/예외: 샘플링 규칙으로 평가셋을 생성하고 실험군/대조군의 유의성 검정을 통해 채택 여부를 결정한다. 입출력: 입력(sampled_conversations, experiment_config) / 출력(quality_report, ab_report). AC: 1) 실패 taxonomy 일관성 유지 2) A-B 결과에 통계 기준 포함 3) 월간 Top 문의 추세 제공. 로그/메트릭: quality_score_avg, ab_lift, top_topic_share. 보안/개인정보: 평가 데이터 접근 최소권한 및 비식별화.",품질 개선 → 평가/A-B,Should,"Python, Notebook, Experiment Framework, BI"
SEC-003,SEC,상,Vault/KMS와 로그 파이프라인 연결,"기능: 내부 API Key/Vault 관리, PII 마스킹, 감사로그/보존정책을 통합 적용한다. 로직/예외: 비밀키는 Vault/KMS 참조만 사용, 요청/응답/로그에 마스킹 미들웨어를 적용하고 보존기간 만료 데이터는 배치 파기한다. 입출력: 입력(secret alias, payload, retention policy) / 출력(masked event, purge report). AC: 1) 평문 키 저장 금지 2) 전화/이메일 패턴 마스킹 3) 보존기간 경과 데이터 자동 처리. 로그/메트릭: secret_rotation_due, pii_mask_hit_rate, retention_purge_count. 보안/개인정보: 감사로그 append-only 및 접근권한 제한.",요청 처리/로그 저장,Must,"Vault/KMS, Spring AOP, Logstash, Batch"
OPS-001,OPS,중,API-006 로그 적재 완료,"기능: 대화량, 해결률, 티켓전환률, 비용, latency/token 지표를 집계하고 알림을 발송한다. 로직/예외: 분 단위 집계와 임계치/이상탐지 알림을 병행하고 중복 알림 억제 윈도우를 적용한다. 입출력: 입력(conversation events, metrics) / 출력(kpi dashboard, alerts). AC: 1) 대시보드 반영 지연 목표 충족 2) 심각도별 알림 채널 분기 3) 알림 확인/종결 이력 저장. 로그/메트릭: kpi_refresh_lag, alert_trigger_count, alert_ack_time. 보안/개인정보: 대시보드 원본 데이터 다운로드 권한 제한.",로그 저장 → 운영 대시보드/알림,Must,"OpenSearch, Micrometer, Alertmanager, BI"
ADM-002,ADM,중,ADM-001 버전관리 체계 운영,"기능: 운영자 계정, 시나리오 플로우, 배포 승인/공지 기능을 통합 제공한다. 로직/예외: 릴리스 노트 템플릿을 강제하고 승인자 서명 없이는 배포 상태 전환을 막는다. 입출력: 입력(release_note, approver, scenario_change) / 출력(release_status, notice). AC: 1) 승인 없는 배포 차단 2) 공지 조회 이력 기록 3) 긴급 공지 플래그 처리. 로그/메트릭: unapproved_release_attempt, notice_publish_count. 보안/개인정보: 운영자 계정 MFA 미설정 시 승인 불가.",관리 콘솔 → 운영자 관리/배포 승인,Should,"Admin UI, Notification Service"
INT-001,INT,중,외부 시스템 API 스펙/인증키 확보,"기능: CRM 프로필, 주문 상태, 배송 추적 API를 표준 DTO로 연동한다. 로직/예외: 고객식별/주문번호/운송장 검증 후 외부 API 호출, 장애 시 캐시 또는 축약 응답으로 폴백한다. 입출력: 입력(customer_id, order_id, tracking_no) / 출력(crm_profile, order_status, shipment_timeline). AC: 1) 잘못된 식별자 검증 오류 처리 2) 외부 장애 시 서비스 연속성 유지 3) 상태코드 내부 표준 매핑. 로그/메트릭: crm_api_ms, order_api_ms, shipping_api_ms. 보안/개인정보: 타 고객 데이터 조회 차단 및 전송구간 암호화.",도구호출 → CRM/주문/배송 조회,Must,"REST Client, Spring Boot, Redis Cache"
SEC-001,SEC,중,인증 저장소 및 키 관리 준비,"기능: JWT 인증, refresh, 세션 만료 정책을 적용한다. 로직/예외: Access/Refresh 수명 분리, refresh 재사용 공격 차단, 실패 누적 시 계정 잠금을 수행한다. 입출력: 입력(credentials or token) / 출력(jwt_pair, auth_status). AC: 1) 만료 토큰 401 일관 처리 2) 잠금/해제 이벤트 기록 3) refresh 토큰 재사용 차단. 로그/메트릭: auth_fail_count, token_refresh_rate. 보안/개인정보: 서명키 회전과 강제 로그아웃 지원.",시스템 진입 → 인증/인가,Must,"Spring Security, JWT, Redis"
UI-008,UI,중,UI 디자인 토큰/컴포넌트 표준화,"기능: ARIA, 키보드 내비게이션, 모바일 반응형 레이아웃을 제공한다. 로직/예외: 핵심 컴포넌트 role/aria-* 적용, 포커스 트랩 유지, 360px~1440px 브레이크포인트에서 자동 레이아웃 전환한다. 입출력: 입력(viewport, keyboard_event) / 출력(accessible_ui_state). AC: 1) 탭 순서와 시각 순서 일치 2) 스크린리더로 새 메시지 읽기 가능 3) 모바일 키보드 오버레이 시 입력창 가림 없음. 로그/메트릭: a11y_violation_count, mobile_layout_shift. 보안/개인정보: 접근성 로그에 원문 메시지 저장 금지.",채팅 위젯 진입 → 접근성/모바일 대응,Must,"React, ARIA, CSS Grid/Flex"
AI-008,AI,중,ADM-001 정책 승인 플로우 운영,"기능: 프롬프트 템플릿 버전관리/승인/롤백을 제공한다. 로직/예외: draft-approved 상태머신으로 배포하고 미승인 버전은 운영 트래픽에 적용하지 않으며, 롤백 요청 시 즉시 이전 버전으로 복귀한다. 입출력: 입력(prompt_version, rollout_ratio) / 출력(active_version, rollout_status). AC: 1) 승인 없는 프롬프트 배포 차단 2) 버전별 성능/비용 비교 가능 3) 롤백 후 응답 안정성 회복. 로그/메트릭: prompt_switch_count, prompt_ab_delta. 보안/개인정보: 프롬프트 본문에 시크릿/고객식별자 하드코딩 금지.",관리 콘솔 → 프롬프트 버전 운영,Should,"Admin UI, Spring Boot, Config Versioning"
AI-009,AI,상,"AI-004, AI-005, SYS-004 구현 완료","기능: 구조화 JSON 스키마 + 인용 필수 + 서버 검증을 강제한다. 로직/예외: 스키마 실패/인용 누락/근거 부족 시 사용자 전송 금지(fail-closed). 입출력: 입력(model_output, evidence_set) / 출력(validated_answer or safe_response). AC: 1) 자유 텍스트 fallback 노출 금지 2) 허용 응답은 ""확인 필요/모름/추가 질문""만 3) 검증 실패율 감시 및 알림. 로그/메트릭: answer_contract_pass_rate, fail_closed_block_count. 보안/개인정보: 근거/로그/캐시 전 구간 PII 마스킹.",응답 생성 → Answer Contract Enforcement,Must,"Structured Output(JSON), JSON Schema Validator, Citation Service"
API-008,API,상,"API-007 공통 규약 적용, 게이트웨이 제한 정책 반영","기능: 입력/출력 토큰 제한, 툴호출 횟수 제한, 검색 TopK 제한, 세션 누적 예산을 적용한다. 로직/예외: 정책 초과 시 429/403 과 함께 안전 메시지를 반환하고 재시도 가능 조건을 안내한다. 입출력: 입력(request budget context) / 출력(policy_decision, http_status). AC: 1) 임계치 초과 요청 100% 차단 2) 에러코드와 사용자 안전메시지 일관성 3) 세션 예산 소진 시 즉시 종료 처리. 로그/메트릭: token_budget_exceeded_count, tool_budget_exceeded_count, topk_guard_trigger_count. 보안/개인정보: PII 마스킹 로그만 저장하고 과도한 요청 패턴을 우회 탐지로 감시한다.",공통 API 처리 → Token/Cost Abuse Guard,Must,"API Gateway, Redis, Budget Service, Policy Engine"
CCH-001,AI,중,ADM-001/ADM-002 승인 워크플로 구성,"기능: 승인된 답변을 저장하고 동일/유사 질문 반복 시 즉시 응답한다. 로직/예외: 정책/템플릿/KB 버전 키를 같이 저장하고 버전 불일치나 폐기 상태면 자동 무효화한다. 입출력: 입력(user_query, version_tuple) / 출력(cached_answer or miss). AC: 1) 버전 키 정합성 보장 2) 무효화 지연 최소화 3) 오래된 답변 노출 금지. 로그/메트릭: answer_bank_hit_rate, invalidation_count.",반복 질문 처리 → 승인 답변 저장소(Answer Bank),Must,"Redis/PostgreSQL, Versioned Answer Store, Cache Invalidation"
CCH-002,AI,중,"CCH-001, SYS-004 관측 구성","기능: semantic cache와 세션 요약 메모리를 활용해 응답 지연을 줄인다. 로직/예외: PII는 저장 제외하고 TTL/정책 기반으로 자동 파기한다. 오탐률 상승 시 캐시를 바이패스한다. 입출력: 입력(query_embedding, session_summary) / 출력(cache_decision, response_context). AC: 1) PII 저장 0건 2) TTL 만료/정책변경 시 무효화 3) 히트율·오탐률 지표 관측. 로그/메트릭: semantic_cache_hit_rate, false_positive_cache_rate.",반복 질문 처리 → Semantic Cache + 세션 요약 메모리,Must,"Redis, Vector Similarity, Session Summarizer"
OPS-003,OPS,상,"OPS-001, SYS-004, 장애대응 권한 분리","기능: 장애/악용 징후 발생 시 즉시조치(계정/IP 차단, 모델 키스위치, 정책/프롬프트/KB 롤백)를 실행한다. 로직/예외: 임계치 초과 알림 수신 후 runbook step을 순차 실행하고, 조치 실패 시 상위 에스컬레이션한다. 입출력: 입력(alert event) / 출력(action result, incident ticket). AC: 1) 즉시조치 실행 가능 2) 조치 이력 감사로그 필수 3) MTTD/MTTR 추적. 로그/메트릭: incident_count, runbook_success_rate, mttd_ms, mttr_ms.",운영 대응 → 즉시조치/런북,Must,"Dashboard, Alert Manager, Runbook, Kill-switch Controller"
ADM-003,ADM,상,"ADM-001, ADM-002 구성 완료","기능: 변경 전/후 diff 확인, 스테이징 검증, 롤아웃 비율 제어를 제공한다. 로직/예외: 승인 완료 후에만 카나리를 시작하고 장애 지표 초과 시 즉시 롤백한다. 입출력: 입력(change_set, rollout_ratio) / 출력(deploy_state, rollback_state). AC: 1) 미승인 배포 차단 2) 비율별 성능/품질 비교 3) 롤백 즉시 실행. 로그/메트릭: canary_pass_rate, rollback_count, config_diff_review_time.",관리 콘솔 → 정책/프롬프트/라우팅 프리뷰 + 점진배포(카나리),Must,"Config Versioning, Diff Viewer, Canary Rollout Controller"
UI-009,UI,중,UI-001~UI-004 구현 완료,"기능: 단축키, 원클릭 복사/삽입, 최근 응답 재사용, 근거 패널 빠른 토글을 제공한다. 로직/예외: 역할 기반으로 허용 기능을 제어하고 오탐 삽입 방지 검증을 수행한다. 입출력: 입력(shortcut/click action) / 출력(composed reply draft). AC: 1) 키보드만으로 핵심 작업 수행 2) 원클릭 삽입 실패율 최소화 3) 최근 응답 재사용 이력 추적. 로그/메트릭: shortcut_usage_count, copy_insert_success_rate, avg_handle_time_delta.",상담원 UX → 생산성 도구,Must,"React, Keyboard Shortcut Manager, Clipboard API, Local State Cache"