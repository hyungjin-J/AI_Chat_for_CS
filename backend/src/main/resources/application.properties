spring.application.name=backend
spring.jackson.property-naming-strategy=SNAKE_CASE

management.endpoints.web.exposure.include=health,info,prometheus
management.endpoint.health.show-details=always

server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

spring.datasource.url=${DB_URL:jdbc:h2:mem:aichatbot;MODE=PostgreSQL;DATABASE_TO_LOWER=TRUE;DEFAULT_NULL_ORDERING=HIGH}
spring.datasource.username=${DB_USERNAME:sa}
spring.datasource.password=${DB_PASSWORD:}
spring.datasource.driver-class-name=${DB_DRIVER:org.h2.Driver}
spring.flyway.enabled=true
spring.flyway.locations=classpath:db/migration
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.timeout=${REDIS_TIMEOUT:2s}

app.jwt.secret=${APP_JWT_SECRET:change-me-in-prod-change-me-in-prod-change-me-in-prod}
app.jwt.access-expiration-sec=${APP_JWT_ACCESS_EXPIRATION_SEC:3600}
app.jwt.refresh-expiration-sec=${APP_JWT_REFRESH_EXPIRATION_SEC:1209600}
app.security.allow-header-auth=${APP_SECURITY_ALLOW_HEADER_AUTH:true}

app.trace.require-header=${APP_TRACE_REQUIRE_HEADER:false}

app.answer.evidence-threshold=${APP_ANSWER_EVIDENCE_THRESHOLD:0.7}
app.rag.top-k-default=${APP_RAG_TOP_K_DEFAULT:3}
app.rag.top-k-max=${APP_RAG_TOP_K_MAX:5}

app.budget.input-token-max=${APP_BUDGET_INPUT_TOKEN_MAX:1500}
app.budget.output-token-max=${APP_BUDGET_OUTPUT_TOKEN_MAX:1500}
app.budget.tool-call-max=${APP_BUDGET_TOOL_CALL_MAX:3}
app.budget.session-budget-max=${APP_BUDGET_SESSION_BUDGET_MAX:10000}
app.budget.sse-concurrency-max-per-user=${APP_BUDGET_SSE_CONCURRENCY_MAX_PER_USER:2}
app.budget.sse-hold-ms=${APP_BUDGET_SSE_HOLD_MS:0}
app.idempotency.store=${APP_IDEMPOTENCY_STORE:memory}
app.idempotency.ttl-seconds=${APP_IDEMPOTENCY_TTL_SECONDS:86400}
app.idempotency.redis-key-prefix=${APP_IDEMPOTENCY_REDIS_KEY_PREFIX:idempotency:}
app.idempotency.redis-fail-strategy=${APP_IDEMPOTENCY_REDIS_FAIL_STRATEGY:fallback_memory}

app.llm.provider=${APP_LLM_PROVIDER:ollama}
app.llm.ollama.base-url=${APP_OLLAMA_BASE_URL:http://localhost:11434}
app.llm.ollama.model=${APP_OLLAMA_MODEL:llama3.2}
